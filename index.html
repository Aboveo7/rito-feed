<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Gaming Feed</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
html,body{
  margin:0;
  background:radial-gradient(circle at top,#111 0%,#000 65%);
  color:#fff;
  font-family:Segoe UI,Arial;
  overflow-x:hidden;
}

/* Hide scrollbar but allow scroll */
*{
  box-sizing:border-box;
  scrollbar-width:none;
}
*::-webkit-scrollbar{display:none}

.container{padding:18px}
.title{
  margin:28px 0 14px;
  letter-spacing:3px;
  font-size:17px;
}

.row{
  display:flex;
  gap:16px;
  overflow-x:auto;
  scroll-behavior:smooth;
}

.card{
  min-width:240px;
  background:#111;
  border-radius:14px;
  overflow:hidden;
  cursor:pointer;
  transition:.25s;
}
.card:hover{transform:scale(1.05)}

.thumb{
  width:100%;
  aspect-ratio:16/9;
  object-fit:cover;
}
.meta{padding:10px;font-size:13px}

.box{
  background:#0f0f0f;
  padding:14px;
  border-radius:14px;
  line-height:1.6;
  opacity:.95;
}
</style>
</head>

<body>
<div class="container" id="app"></div>

<script>
/* ================== API SETUP ================== */
/* ðŸ”´ PASTE YOUR API KEY BETWEEN THE QUOTES BELOW */
const _k = "AIzaSyDWyU8Ldkg0ykxX-KIXi-a-59oiPNWAzxI";
/* ðŸ”´ CHANNEL ID */
const CHANNEL_ID = "UCeq1rnutfneY2AUe3Fi7gTA";

/* API base */
const API = "https://www.googleapis.com/youtube/v3";

/* ================== CACHE ================== */
const CACHE_KEY = "yt_cache_data";
const WEEK_KEY  = "yt_week_pick";
const LAST_CHECK = "yt_last_check";

/* ================== HELPERS ================== */
const app = document.getElementById("app");

function openVideo(id){
  window.open("https://youtube.com/watch?v="+id,"_blank");
}

function isShort(v){
  const d=v.contentDetails?.duration||"";
  return d.includes("S") && !d.includes("M") && !d.includes("H");
}

function isVideo(v){
  const d=v.contentDetails?.duration||"";
  if(isShort(v)) return false;
  return d.includes("M") || d.includes("H");
}

function card(v){
  return `
  <div class="card" onclick="openVideo('${v.id}')">
    <img class="thumb" src="${v.snippet.thumbnails.high.url}">
    <div class="meta">${v.snippet.title}</div>
  </div>`;
}

async function safeFetch(url){
  try{
    const r=await fetch(url);
    if(!r.ok) throw 0;
    return await r.json();
  }catch{
    return null;
  }
}

/* ================== SUMMARY AI ================== */
function buildSummary(videos){
  const topics={};
  videos.forEach(v=>{
    const title=v.snippet.title.toLowerCase();
    const views=parseInt(v.statistics.viewCount||0);
    title.split(" ").forEach(w=>{
      if(w.length<4) return;
      topics[w]=(topics[w]||0)+views;
    });
  });

  const top=Object.entries(topics).sort((a,b)=>b[1]-a[1])[0];
  if(!top) return "The channel shows consistent gaming uploads with balanced performance.";

  return `The channel performs best in content related to "${top[0]}". 
The creator focuses on this style frequently, and it attracts stronger viewer engagement compared to other uploads. 
Overall, the content strategy feels focused and audience-driven.`;
}

/* ================== MAIN ================== */
async function loadFeed(force=false){
  const now=Date.now();
  const last=parseInt(localStorage.getItem(LAST_CHECK)||0);

  if(!force && now-last<24*60*60*1000){
    const cached=localStorage.getItem(CACHE_KEY);
    if(cached){
      render(JSON.parse(cached));
      return;
    }
  }

  const search=await safeFetch(
    `${API}/search?part=id&channelId=${CHANNEL_ID}&type=video&maxResults=30&key=${_k}`
  );
  if(!search){
    const cached=localStorage.getItem(CACHE_KEY);
    if(cached) render(JSON.parse(cached));
    return;
  }

  const ids=search.items.map(i=>i.id.videoId).join(",");
  const data=await safeFetch(
    `${API}/videos?part=snippet,statistics,contentDetails,liveStreamingDetails&id=${ids}&key=${_k}`
  );
  if(!data){
    const cached=localStorage.getItem(CACHE_KEY);
    if(cached) render(JSON.parse(cached));
    return;
  }

  localStorage.setItem(CACHE_KEY,JSON.stringify(data.items));
  localStorage.setItem(LAST_CHECK,now);
  render(data.items);
}

function render(items){
  app.innerHTML="";

  const videos=items.filter(v=>isVideo(v) && !v.liveStreamingDetails);
  const shorts=items.filter(isShort);
  const streams=items.filter(v=>v.liveStreamingDetails);

  /* Weekly recommendation */
  let weekPick=localStorage.getItem(WEEK_KEY);
  if(!weekPick){
    weekPick=videos[Math.floor(Math.random()*videos.length)]?.id;
    localStorage.setItem(WEEK_KEY,weekPick);
  }
  const weekly=videos.find(v=>v.id===weekPick);

  /* Videos */
  const mostViewed=[...videos].sort((a,b)=>b.statistics.viewCount-a.statistics.viewCount);
  const videoList=[mostViewed[0],...videos.filter(v=>v!==mostViewed[0]).sort(()=>0.5-Math.random())];

  app.innerHTML+=`
  <div class="title">WEEKLY RECOMMENDATION</div>
  <div class="row">${weekly?card(weekly):""}</div>

  <div class="title">VIDEOS</div>
  <div class="row">${videoList.map(card).join("")}</div>

  <div class="title">LIVE STREAMS</div>
  <div class="row">${streams.length?streams.map(card).join(""):""}</div>

  <div class="title">SHORTS</div>
  <div class="row">${shorts.sort(()=>0.5-Math.random()).map(card).join("")}</div>

  <div class="title">SUMMARY</div>
  <div class="box">${buildSummary(videos)}</div>
  `;
}

/* Initial load */
loadFeed();

/* Check once every hour only for change */
setInterval(()=>loadFeed(),60*60*1000);
</script>
</body>
</html>
